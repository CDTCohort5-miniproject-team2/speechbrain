# Generated 2023-02-21 from:
# /netscratch/sagar/thesis/speechbrain/recipes/DNS/enhancement/hparams/resume-sepformer-dns_16k.yaml
# yamllint disable
# ################################
# Model: SepFormer for source separation
# https://arxiv.org/abs/2010.13154
#
# Author:  Sangeet Sagar 2022
# Dataset : Microsoft-DNS
# ################################

# Basic parameters
sample_rate: 16000
num_spks: 1

# Specifying the network
Encoder: &id003 !new:speechbrain.lobes.models.dual_path.Encoder
  kernel_size: 16
  out_channels: 256

SBtfintra: &id001 !new:speechbrain.lobes.models.dual_path.SBTransformerBlock
  num_layers: 8
  d_model: 256
  nhead: 8
  d_ffn: 1024
  dropout: 0
  use_positional_encoding: true
  norm_before: true

SBtfinter: &id002 !new:speechbrain.lobes.models.dual_path.SBTransformerBlock
  num_layers: 8
  d_model: 256
  nhead: 8
  d_ffn: 1024
  dropout: 0
  use_positional_encoding: true
  norm_before: true

MaskNet: &id005 !new:speechbrain.lobes.models.dual_path.Dual_Path_Model
  num_spks: 1
  in_channels: 256
  out_channels: 256
  num_layers: 2
  K: 250
  intra_model: *id001
  inter_model: *id002
  norm: ln
  linear_layer_after_inter_intra: false
  skip_around_intra: true

Decoder: &id004 !new:speechbrain.lobes.models.dual_path.Decoder
  in_channels: 256
  out_channels: 1
  kernel_size: 16
  stride: 8
  bias: false

modules:
  encoder: *id003
  decoder: *id004
  masknet: *id005

pretrainer: !new:speechbrain.utils.parameter_transfer.Pretrainer
  loadables:
    encoder: !ref <Encoder>
    masknet: !ref <MaskNet>
    decoder: !ref <Decoder>
